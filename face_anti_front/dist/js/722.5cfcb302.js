"use strict";(self["webpackChunkface_anti_front"]=self["webpackChunkface_anti_front"]||[]).push([[722],{2722:function(e,t,a){a.r(t),a.d(t,{default:function(){return f}});a(4603),a(7566),a(8721);var n=a(6768),o=(a(7796),a(144));const c=e=>((0,n.Qi)("data-v-371ed02f"),e=e(),(0,n.jt)(),e),l={class:"container"},i={style:{display:"flex","flex-direction":"row"}},d=c((()=>(0,n.Lk)("canvas",{id:"camera"},null,-1))),s=c((()=>(0,n.Lk)("div",null,[(0,n.Lk)("canvas",{id:"camera_result"})],-1))),r={class:"botton_box"};var u={__name:"onlineAlaysis",setup(e){const t=(0,o.KR)();(0,o.KR)();let a=0;const c=(0,o.KR)(),u=((0,o.KR)(),(0,o.KR)()),v=new WebSocket("ws://localhost:8888");function g(){v.onopen=()=>{console.log("socket 已打开...")}}async function f(){console.log("Attempting to reconnect..."),setTimeout(g(),3e3)}function m(){c.value=document.getElementById("camera"),u.value=c.value.getContext("2d"),navigator.mediaDevices?navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((e=>{t.value.srcObject=e,t.value.play();let n=new MediaRecorder(e);n.ondataavailable=e=>{if(e.data&&e.data.size>0&&1===a){const e=document.createElement("canvas");e.width=t.value.videoWidth,e.height=t.value.videoHeight;const a=e.getContext("2d");a.drawImage(t.value,0,0,e.width,e.height);const n=e.toDataURL("image/jpeg");v.send(n)}},n.start(33)})).catch((e=>{console.log(e)})):navigator.mediaDevices={}}function k(){let e=t.value.srcObject;if(!e)return;let a=e.getTracks();a.forEach((e=>{e.stop()}))}function h(){a=1,console.log("开始检测"),v.onmessage=e=>{console.log(e.data);let t=e.data;if(t instanceof Blob&&null!==document.getElementById("camera_result")){const e=document.getElementById("camera_result").getContext("2d"),a=document.getElementById("camera_result"),n=URL.createObjectURL(t),o=new Image;o.onload=()=>{a.width=o.width,a.height=o.height,e.drawImage(o,0,0),URL.revokeObjectURL(n)},o.src=n}else console.error("Received data is not a Blob object.")}}function b(){a=0,console.log("关闭检测")}return(0,n.sV)((()=>{console.log("正在打开摄像头。。。"),m(),g(),f()})),(0,n.xo)((()=>{})),(e,a)=>{const o=(0,n.g2)("el-button");return(0,n.uX)(),(0,n.CE)("div",l,[(0,n.Lk)("div",i,[(0,n.Lk)("div",null,[(0,n.Lk)("video",{src:"",ref_key:"video",ref:t,id:"video"},null,512),d]),s]),(0,n.Lk)("div",r,[(0,n.bF)(o,{type:"primary",onClick:a[0]||(a[0]=e=>m())},{default:(0,n.k6)((()=>[(0,n.eW)("打开摄像头")])),_:1}),(0,n.bF)(o,{type:"danger",onClick:a[1]||(a[1]=e=>k())},{default:(0,n.k6)((()=>[(0,n.eW)("关闭摄像头")])),_:1}),(0,n.bF)(o,{type:"primary",onClick:a[2]||(a[2]=e=>h())},{default:(0,n.k6)((()=>[(0,n.eW)("开始检测")])),_:1}),(0,n.bF)(o,{type:"danger",onClick:a[3]||(a[3]=e=>b())},{default:(0,n.k6)((()=>[(0,n.eW)("关闭检测")])),_:1}),(0,n.bF)(o,{type:"primary",onClick:a[4]||(a[4]=function(){})},{default:(0,n.k6)((()=>[(0,n.eW)("保存截图")])),_:1})])])}}},v=a(1241);const g=(0,v.A)(u,[["__scopeId","data-v-371ed02f"]]);var f=g}}]);
//# sourceMappingURL=722.5cfcb302.js.map