{"ast":null,"code":"import { ref, onMounted, onUnmounted } from 'vue';\nexport default {\n  __name: 'onlineAlaysis',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const video = ref();\n    const mediaStreamTrack = ref({});\n    const videoStream = ref('');\n    const canvas = ref();\n    const ctx = ref();\n    onMounted(() => {\n      console.log('正在打开摄像头。。。');\n      getCamera();\n      console.log('摄像头已关闭。。。');\n    });\n    function getCamera() {\n      canvas.value = document.getElementById('camera');\n      ctx.value = canvas.value.getContext('2d');\n      if (navigator.mediaDevices) {\n        navigator.mediaDevices.getUserMedia({\n          video: true,\n          audio: false\n        }).then(stream => {\n          video.value.srcObject = stream;\n          video.value.play();\n          console.log('摄像头已打开。。。');\n          mediaStreamTrack.value = stream.getTracks()[0];\n          console.log('摄像头已打开。。。');\n        }).catch(err => {\n          console.log(err);\n        });\n      } else {\n        //防止浏览器版本旧不支持mediaDevices\n        navigator.mediaDevices = {};\n      }\n    }\n    onUnmounted(() => {\n      setTimeout(() => {\n        if (video.value && video.value.srcObject) {\n          video.value.srcObject.getTracks().forEach(track => track.stop());\n          console.log('摄像头已关闭。。。');\n        }\n      }, 1000); // 延迟 1 秒后执行销毁操作\n    });\n    const __returned__ = {\n      video,\n      mediaStreamTrack,\n      videoStream,\n      canvas,\n      ctx,\n      getCamera,\n      ref,\n      onMounted,\n      onUnmounted\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","onUnmounted","video","mediaStreamTrack","videoStream","canvas","ctx","console","log","getCamera","value","document","getElementById","getContext","navigator","mediaDevices","getUserMedia","audio","then","stream","srcObject","play","getTracks","catch","err","setTimeout","forEach","track","stop"],"sources":["C:/Users/31136/Desktop/face_anti_front/src/components/onlineAlaysis.vue"],"sourcesContent":["<template>\r\n <div class=\"container\">\r\n    <video src=\"\" ref=\"video\" id=\"video\"></video>\r\n    <canvas id=\"camera\"></canvas>\r\n </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref,onMounted,onUnmounted} from 'vue';\r\nconst video = ref()\r\nconst mediaStreamTrack = ref({})\r\nconst videoStream = ref('')\r\nconst canvas = ref()\r\nconst ctx = ref()\r\nonMounted(()=>{\r\n    console.log('正在打开摄像头。。。')\r\n    getCamera();\r\n    console.log('摄像头已关闭。。。')\r\n})\r\nfunction getCamera(){\r\n    canvas.value = document.getElementById('camera');\r\n    ctx.value = canvas.value.getContext('2d');\r\n    if(navigator.mediaDevices){\r\n        navigator.mediaDevices.getUserMedia({video:true,audio:false}).then((stream)=>{\r\n            video.value.srcObject = stream;\r\n            video.value.play();\r\n            console.log('摄像头已打开。。。')\r\n            mediaStreamTrack.value = stream.getTracks()[0];\r\n            console.log('摄像头已打开。。。')\r\n        }).catch((err)=>{\r\n            console.log(err)\r\n        })\r\n    }else{\r\n        //防止浏览器版本旧不支持mediaDevices\r\n        navigator.mediaDevices={}\r\n    }\r\n}\r\nonUnmounted(()=>{\r\n    setTimeout(() => {\r\n        if (video.value && video.value.srcObject) {\r\n            video.value.srcObject.getTracks().forEach(track => track.stop());\r\n            console.log('摄像头已关闭。。。');\r\n        }\r\n    }, 1000); // 延迟 1 秒后执行销毁操作\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.container{\r\n    width:100vw;\r\n    height:100vh;\r\n    background-color: #000;\r\n}\r\n#camera{\r\n}\r\n#video{\r\n    margin-left: 10vw;\r\n    width:60vw\r\n}\r\n</style>"],"mappings":"AAQA,SAAQA,GAAG,EAACC,SAAS,EAACC,WAAW,QAAO,KAAK;;;;;;;IAC7C,MAAMC,KAAK,GAAGH,GAAG,CAAC,CAAC;IACnB,MAAMI,gBAAgB,GAAGJ,GAAG,CAAC,CAAC,CAAC,CAAC;IAChC,MAAMK,WAAW,GAAGL,GAAG,CAAC,EAAE,CAAC;IAC3B,MAAMM,MAAM,GAAGN,GAAG,CAAC,CAAC;IACpB,MAAMO,GAAG,GAAGP,GAAG,CAAC,CAAC;IACjBC,SAAS,CAAC,MAAI;MACVO,OAAO,CAACC,GAAG,CAAC,YAAY,CAAC;MACzBC,SAAS,CAAC,CAAC;MACXF,OAAO,CAACC,GAAG,CAAC,WAAW,CAAC;IAC5B,CAAC,CAAC;IACF,SAASC,SAASA,CAAA,EAAE;MAChBJ,MAAM,CAACK,KAAK,GAAGC,QAAQ,CAACC,cAAc,CAAC,QAAQ,CAAC;MAChDN,GAAG,CAACI,KAAK,GAAGL,MAAM,CAACK,KAAK,CAACG,UAAU,CAAC,IAAI,CAAC;MACzC,IAAGC,SAAS,CAACC,YAAY,EAAC;QACtBD,SAAS,CAACC,YAAY,CAACC,YAAY,CAAC;UAACd,KAAK,EAAC,IAAI;UAACe,KAAK,EAAC;QAAK,CAAC,CAAC,CAACC,IAAI,CAAEC,MAAM,IAAG;UACzEjB,KAAK,CAACQ,KAAK,CAACU,SAAS,GAAGD,MAAM;UAC9BjB,KAAK,CAACQ,KAAK,CAACW,IAAI,CAAC,CAAC;UAClBd,OAAO,CAACC,GAAG,CAAC,WAAW,CAAC;UACxBL,gBAAgB,CAACO,KAAK,GAAGS,MAAM,CAACG,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;UAC9Cf,OAAO,CAACC,GAAG,CAAC,WAAW,CAAC;QAC5B,CAAC,CAAC,CAACe,KAAK,CAAEC,GAAG,IAAG;UACZjB,OAAO,CAACC,GAAG,CAACgB,GAAG,CAAC;QACpB,CAAC,CAAC;MACN,CAAC,MAAI;QACD;QACAV,SAAS,CAACC,YAAY,GAAC,CAAC,CAAC;MAC7B;IACJ;IACAd,WAAW,CAAC,MAAI;MACZwB,UAAU,CAAC,MAAM;QACb,IAAIvB,KAAK,CAACQ,KAAK,IAAIR,KAAK,CAACQ,KAAK,CAACU,SAAS,EAAE;UACtClB,KAAK,CAACQ,KAAK,CAACU,SAAS,CAACE,SAAS,CAAC,CAAC,CAACI,OAAO,CAACC,KAAK,IAAIA,KAAK,CAACC,IAAI,CAAC,CAAC,CAAC;UAChErB,OAAO,CAACC,GAAG,CAAC,WAAW,CAAC;QAC5B;MACJ,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC;IACd,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}